# Урок 14. Git Fork в контексте PR

## План урока
- Что такое Git Fork
- Issue в GitHub
- Pull Requests в Git и GitHub
- Задание для закрепления

---

## 1) Что такое Git Fork

**Git fork** — это операция, которая создает копию удаленного репозитория на платформе Git, обычно на сервере, таком как GitHub или GitLab.

### Ключевые особенности

#### Создание копии репозитория
Git fork позволяет создать копию проекта на платформе Git.

#### Ваш репозиторий
Репозиторий, который вы получаете после fork — ваш, можно делать с ним что угодно. Форк позволяет вам вносить свои изменения в проект, а затем предложить их для интеграции в исходный репозиторий через pull request.

#### Изоляция работы
Git fork позволяет изолировать вашу работу от оригинального репозитория, обеспечивая безопасное пространство для экспериментов и изменений.

#### Связь с оригиналом
Git fork оставляет связь с оригинальным репозиторием, что позволяет обновлять его содержимое, взяв коммиты из оригинального репозитория.

#### Коллаборация
Git fork и последующие Pull Requests позволяют командам и сообществам сотрудничать над проектами, предлагая изменения через Pull Request, которые могут быть рассмотрены и внесены в оригинальный проект.

---

## 2) Пример использования Git Fork

### Шаг 1: Создание форка
На платформе GitHub или GitLab:
1. Перейдите на страницу исходного репозитория (например, `https://github.com/aliaskov/bashscripts`)
2. Нажмите кнопку **"Fork"**

### Шаг 2: Клонирование форкнутого репозитория
После этого вы можете склонировать этот репозиторий, так как он теперь ваш, но сохраняет связь с репозиторием, по которому он был форкнут:

```bash
git clone https://github.com/YOUR_USERNAME/bashscripts.git
cd bashscripts
```

---

## 3) Issue в GitHub

**Issue (задача)** в GitHub представляет собой место для обсуждения, отслеживания и управления работой над конкретной задачей или проблемой в проекте.

### Что представляет собой Issue
Каждая задача (issue) обычно представляет собой:
- Определенное изменение
- Исправление ошибки
- Предложение новой функциональности
- Общую проблему, требующую внимания

### Структура Issue

#### Название и описание
Каждая задача имеет название и описание, которые помогают понять суть проблемы или предложенного изменения.

#### Метки (Labels)
Метки используются для классификации задач по различным категориям:
- `bug` (ошибка)
- `enhancement` (улучшение)
- `documentation` (документация)
- И т.д.

Они помогают организовать и фильтровать задачи.

---

## 4) Pull Requests в Git и GitHub

**Pull Request** — это механизм, предоставляемый некоторыми платформами совместной разработки, такими как GitHub, для предложения внесения изменений из одной ветки или форка в другую ветку или репозиторий.

### Рабочий процесс Pull Request

1. **Вытащить изменения** на ваш компьютер (получить самую последнюю версию изменений)
2. **Создать "ветку"** (версию)
3. **Зафиксировать изменения** (закоммитить)
4. **Загрузить (запушить)** ваши изменения
5. **Открыть "Pull Request"** (предложить изменения)
6. **Обсудить и прорецензировать** ваш код
7. **Произвести ребейз и тестирование**
8. **"Слить" (смержить)** вашу ветку с основной веткой

---

## 5) Подробно по шагам

### Шаг 1: Создать "ветку" (версию)

Создаем новую ветку и называем ее "feature_x" и переключаемся на нее:

```bash
git checkout -b feature_x
```

### Шаг 2: Commits (коммитим)

```bash
git add <filename>
# или
git add *

git commit -m "Commit message"
```

**Совет:** Сообщения коммитов важны, они описывают историю вашего кода. Написание понятных сообщений коммитов может сделать процесс восприятия вашего кода более простым для других людей и позволит им дать обратную связь.

### Шаг 3a: Загрузить (запушить) ваши изменения

Ветка не доступна другим пользователям, пока вы не загрузите её в ваш удаленный репозиторий:

```bash
git push origin <branch>
```

### Шаг 3b: Открыть Pull Request

Pull Request инициирует обсуждение ваших коммитов. Вы можете открыть Pull Request в любой момент:

- Когда у вас мало или вообще нет кода, но вы хотите поделиться скриншотами или общими идеями
- Когда вы застряли и нуждаетесь в помощи или совете
- Когда вы готовы к тому, чтобы кто-то прорецензировал вашу работу

**Как открыть PR:**
1. Перейдите в свой репозиторий на GitHub
2. Нажмите кнопку "Pull requests"
3. Нажмите "New pull request"
4. Выберите ветки для сравнения
5. Нажмите "Create pull request"
6. Заполните описание и нажмите "Create pull request"

### Шаг 4: Обсудить и прорецензировать ваш код

Как только Pull Request открыт, человек или команда, рецензирующая ваши изменения, может:
- Обсудить с автором предложенные изменения
- Указать на конкретные строки или файлы в предложенных изменениях
- Оставить комментарии и предложения
- Запросить изменения

### Шаг 5: Ребейз и тестирование

Как только ваш pull request пройдет рецензирование, а ветка пройдет ваши тесты, вы можете перебазировать (rebase) вашу ветку на master.

Чтобы воспроизвести все изменения и все коммиты на ветке master или main:

```bash
git rebase master
```

### Шаг 6: Merge — "Слить" (смержить) вашу ветку с основной веткой

Теперь, когда ваши изменения были проверены на продакшн, пришло время объединить ваш код с веткой master.

```bash
git checkout master
git merge <branch>
```

Или через интерфейс GitHub:
1. Откройте ваш Pull Request
2. Нажмите кнопку "Merge pull request"
3. Подтвердите слияние

---

## 6) Задание для закрепления

### Задание 1: Создание Issue
Создайте issue в репозитории преподавателя или того, кто будет показывать экран в процессе занятия. Опишите проблему или задачу.

### Задание 2: Форк репозитория
Форкните репозиторий преподавателя или того, кто будет показывать экран в процессе занятия.

### Задание 3: Внесение изменений
Внесите изменения в своей копии репозитория (например, добавьте файлы или измените изменения в файлы — добавив дату в README).

### Задание 4: Работа с ветками (дополнительно)
Для практики веток в git — переключитесь на новую ветку, отличную от main или master.

### Задание 5: Открытие PR
Откройте PR в оригинальный репозиторий преподавателя или того, кто будет показывать экран в процессе занятия из ветки main или т.н. Feature branch, которую вы создали ранее. Не забудьте сослаться на issue (`#НОМЕР_ISSUE`), который вы пытаетесь решить.

### Задание 6: Просмотр со стороны владельца
Обратите внимание на то, как выглядит новый PR со стороны владельца репозитория.

### Задание 7: Работа с комментариями
Отработайте сценарий, когда владелец репозитория, в котором открыт PR, не согласен с некоторыми файлами и строками кода в предложенном PR. Попробуйте функционал уведомлений и чата в открытом PR. Обратите внимание на динамичные уведомления.

### Задание 8: Обновление PR
Внесите изменения в локальных репозиториях, выполните коммит изменений (или несколько) и убедитесь, что они появятся в открытом PR, новый открывать не нужно (только если открытый PR не был закрыт).

### Задание 9: Merge PR
Выполните merge этого PR. Рассмотрите функционал:
- **Rebase and merge** — перебазирует коммиты на базовую ветку
- **Squash and merge** — объединяет все коммиты в один

### Задание 10: Pull и следующий PR
Выполните pull в репозиториях и выполните merge следующего PR.

---

## Резюме

**Git Fork** — механизм создания копии репозитория для независимой работы:
- Позволяет экспериментировать без риска повредить оригинальный проект
- Сохраняет связь с оригинальным репозиторием
- Используется для предложения изменений через Pull Request

**Issue** — инструмент для отслеживания задач и проблем:
- Организация работы над проектом
- Обсуждение проблем и предложений
- Классификация через метки (labels)

**Pull Request** — механизм для предложения и рецензирования изменений:
- Инициирует обсуждение кода
- Позволяет рецензировать изменения перед слиянием
- Способствует качественной коллаборации в команде
- Поддерживает различные стратегии слияния (merge, rebase, squash)


---

## Дополнительные материалы

### Синхронизация форка с оригиналом

```bash
# Добавить оригинальный репозиторий как upstream
git remote add upstream https://github.com/original/repo.git

# Получить изменения из upstream
git fetch upstream

# Слить изменения в свою ветку
git checkout main
git merge upstream/main

# Или rebase
git rebase upstream/main

# Отправить обновления в свой fork
git push origin main
```

### Работа с Draft Pull Request

GitHub позволяет создавать черновики PR:
- Помечены как "Work in Progress"
- Не могут быть смержены до готовности
- Полезны для раннего обсуждения

```bash
# Создать через GitHub CLI
gh pr create --draft --title "WIP: New feature"
```

### Code Review Best Practices

**Для автора PR:**
- Небольшие PR (до 400 строк) легче ревьюить
- Четкое описание изменений
- Ссылка на issue
- Скриншоты/демо если применимо
- Самостоятельная проверка перед созданием PR

**Для ревьюера:**
- Конструктивная критика
- Проверка не только кода, но и тестов
- Предложение улучшений, а не требование
- Быстрый feedback (в течение дня)

### GitHub Actions для PR

```yaml
# .github/workflows/pr-check.yml
name: PR Checks
on: [pull_request]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Run tests
        run: npm test
      - name: Lint
        run: npm run lint
```

### Автоматизация с GitHub CLI

```bash
# Установка GitHub CLI
# Ubuntu/Debian
sudo apt install gh

# Аутентификация
gh auth login

# Создать PR
gh pr create --title "Fix bug" --body "Description"

# Список PR
gh pr list

# Просмотр PR
gh pr view 123

# Checkout PR локально
gh pr checkout 123

# Merge PR
gh pr merge 123 --squash

# Комментировать PR
gh pr comment 123 --body "Looks good!"
```

### Шаблоны для PR и Issue

**`.github/pull_request_template.md`**
```markdown
## Description
Brief description of changes

## Type of change
- [ ] Bug fix
- [ ] New feature
- [ ] Breaking change

## Checklist
- [ ] Tests added
- [ ] Documentation updated
- [ ] Code follows style guide
```

**`.github/ISSUE_TEMPLATE/bug_report.md`**
```markdown
---
name: Bug report
about: Create a report to help us improve
---

**Describe the bug**
A clear description

**To Reproduce**
Steps to reproduce

**Expected behavior**
What you expected

**Screenshots**
If applicable
```

### Ресурсы

- [GitHub Docs: Pull Requests](https://docs.github.com/en/pull-requests)
- [GitHub CLI](https://cli.github.com/)
- [Conventional Commits](https://www.conventionalcommits.org/) — стандарт сообщений коммитов
- [How to Write a Git Commit Message](https://chris.beams.io/posts/git-commit/)
