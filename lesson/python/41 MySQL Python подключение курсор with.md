# MySQL Python –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫—É—Ä—Å–æ—Ä with

## üìñ –ë—ã—Å—Ç—Ä–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞–º –∏ —Ñ—É–Ω–∫—Ü–∏—è–º

- [–ü–ª–∞–Ω —É—Ä–æ–∫–∞](#0-–ø–ª–∞–Ω-—É—Ä–æ–∫–∞)
- [–ó–∞—á–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ë–î –∏–∑ Python](#1-–∑–∞—á–µ–º-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å-–±–¥-–∏–∑-python)
- [–ë–∏–±–ª–∏–æ—Ç–µ–∫–∏ –¥–ª—è MySQL –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ PyMySQL](#2-–±–∏–±–ª–∏–æ—Ç–µ–∫–∏-–¥–ª—è-mysql-–∏-—É—Å—Ç–∞–Ω–æ–≤–∫–∞-pymysql)
- [–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö](#3-–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ-–∫-–±–∞–∑–µ-–¥–∞–Ω–Ω—ã—Ö)
- [–ö—É—Ä—Å–æ—Ä: –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ SQL –∏–∑ Python](#4-–∫—É—Ä—Å–æ—Ä-–≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ-sql-–∏–∑-python)
- [–ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤: `fetchone`, `fetchmany`, `fetchall...](#5-–ø–æ–ª—É—á–µ–Ω–∏–µ-—Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤-fetchone-fetchmany-fetchall-–∏—Ç–µ—Ä–∞—Ü–∏—è-–ø–æ-–∫—É—Ä—Å–æ—Ä—É)

**[üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∏ –ø—Ä–∏–º–µ—Ä—ã](#–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è-–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è)**


> –†–∞–±–æ—Ç–∞ —Å MySQL –∏–∑ Python: –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ, –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤, –±–µ–∑–æ–ø–∞—Å–Ω–∞—è –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã—Ö –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤.

---

## 0) –ü–ª–∞–Ω —É—Ä–æ–∫–∞

- –ó–∞—á–µ–º –≤–æ–æ–±—â–µ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ MySQL –∏–∑ Python (PyMySQL)
- –†–∞–±–æ—Ç–∞ —Å –∫—É—Ä—Å–æ—Ä–æ–º
- –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∑–∞–ø—Ä–æ—Å–∞
- –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã (`%s`)
- –ò–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (`%(name)s`)
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ (`try/except`, `pymysql.MySQLError`)
- –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä `with` –¥–ª—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –∏ –∫—É—Ä—Å–æ—Ä–∞

---

## 1) –ó–∞—á–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ë–î –∏–∑ Python

–ö–æ–≥–¥–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∞ —Ä–∞—Å—Ç—ë—Ç, –ø–æ—è–≤–ª—è—é—Ç—Å—è:
- –∑–∞–∫–∞–∑—ã, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, —Å–æ–æ–±—â–µ–Ω–∏—è, –ª–æ–≥–∏ –∏ —Ç.–¥.  
- –Ω—É–∂–Ω–æ **—Ö—Ä–∞–Ω–∏—Ç—å –º–Ω–æ–≥–æ –¥–∞–Ω–Ω—ã—Ö**, –±—ã—Å—Ç—Ä–æ –∏—Å–∫–∞—Ç—å/–æ–±–Ω–æ–≤–ª—è—Ç—å, –¥–∞–≤–∞—Ç—å –¥–æ—Å—Ç—É–ø –Ω–µ—Å–∫–æ–ª—å–∫–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º.

–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (MySQL):
- —Ö—Ä–∞–Ω–∏—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤–Ω–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã;
- –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å –æ—á–µ–Ω—å –±–æ–ª—å—à–∏–º–∏ –æ–±—ä—ë–º–∞–º–∏ –±–µ–∑ –∑–∞–≥—Ä—É–∑–∫–∏ –≤—Å–µ–≥–æ –≤ –ø–∞–º—è—Ç—å;
- –¥–∞—ë—Ç –º–Ω–æ–≥–æ–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –¥–æ—Å—Ç—É–ø –∏ –∑–∞—â–∏—Ç—É;
- –¥–µ–ª–∞–µ—Ç —Å–∏—Å—Ç–µ–º—É –Ω–∞–¥—ë–∂–Ω–æ–π –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ–π.

–î–ª—è Python –µ—Å—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫–∏-–∫–ª–∏–µ–Ω—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ:
- —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å MySQL,
- –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç SQL-–∑–∞–ø—Ä–æ—Å—ã –∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã,
- –ø—Ä–µ–≤—Ä–∞—â–∞—é—Ç –æ—à–∏–±–∫–∏ –ë–î –≤ –∏—Å–∫–ª—é—á–µ–Ω–∏—è Python.

---

## 2) –ë–∏–±–ª–∏–æ—Ç–µ–∫–∏ –¥–ª—è MySQL –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ PyMySQL

–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã:

| –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞               | –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏                                      |
|--------------------------|--------------------------------------------------|
| `PyMySQL`                | –ü—Ä–æ—Å—Ç–∞—è, –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞ Python, –ª–µ–≥–∫–æ —Å—Ç–∞–≤–∏—Ç—Å—è    |
| `mysql-connector-python` | –û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –¥—Ä–∞–π–≤–µ—Ä –æ—Ç MySQL                    |
| `MySQLdb (mysqlclient)`  | –û—á–µ–Ω—å –±—ã—Å—Ç—Ä–∞—è, –Ω–æ —Å–ª–æ–∂–Ω–µ–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ (–æ—Å–æ–±–µ–Ω–Ω–æ Windows) |

–í –∫—É—Ä—Å–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **PyMySQL** (–∫—Ä–æ—Å—Å–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–æ –∏ –±–µ–∑ –±–æ–ª–∏).

–£—Å—Ç–∞–Ω–æ–≤–∫–∞:

```bash
pip install pymysql
```

---

## 3) –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

### –ë–∞–∑–æ–≤—ã–π –≤–∞—Ä–∏–∞–Ω—Ç

```py
import pymysql  # –∏–º–ø–æ—Ä—Ç –º–æ–¥—É–ª—è

connection = pymysql.connect(
    host="localhost",        # –∞–¥—Ä–µ—Å —Å–µ—Ä–≤–µ—Ä–∞
    user="root",             # –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
    password="yourpassword", # –ø–∞—Ä–æ–ª—å
    database="yourdatabase", # –∏–º—è –ë–î (–º–æ–∂–Ω–æ –æ–ø—É—Å—Ç–∏—Ç—å)
    charset="utf8mb4",       # –∫–æ–¥–∏—Ä–æ–≤–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è (–¥–ª—è —Ä—É—Å—Å–∫–æ–≥–æ —Ç–µ–∫—Å—Ç–∞)
)
```

### –ö–æ–Ω—Ñ–∏–≥ —Å–ª–æ–≤–∞—Ä—ë–º + —Ä–∞—Å–ø–∞–∫–æ–≤–∫–∞ `**`

–£–¥–æ–±–Ω–æ, –µ—Å–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è/–ª–µ–∂–∞—Ç –≤ —Ñ–∞–π–ª–µ `.env`, JSON, YAML –∏ —Ç.–ø.:

```py
import pymysql

config = {
    "host": "ich-db.edu.itcareerhub.de",
    "user": "ich1",
    "password": "password",
    "database": "hr",
}

connection = pymysql.connect(**config)  # —Ä–∞—Å–ø–∞–∫–æ–≤–∫–∞ —Å–ª–æ–≤–∞—Ä—è –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –∏ –∑–∞–∫—Ä—ã—Ç–∏–µ

```py
if connection.open:
    print("Connection successful!")

connection.close()
```

–ü–æ—á–µ–º—É –≤–∞–∂–Ω–æ –∑–∞–∫—Ä—ã–≤–∞—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ:
- –∫–∞–∂–¥–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∑–∞–Ω–∏–º–∞–µ—Ç —Ä–µ—Å—É—Ä—Å—ã —Å–µ—Ä–≤–µ—Ä–∞;
- –µ—Å—Ç—å –ª–∏–º–∏—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π;
- —Ö–æ—Ä–æ—à–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞: –∑–∞–∫—Ä—ã–≤–∞—Ç—å —Å—Ä–∞–∑—É, –∫–∞–∫ —Ç–æ–ª—å–∫–æ –Ω–µ –Ω—É–∂–Ω–æ.

---

## 4) –ö—É—Ä—Å–æ—Ä: –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ SQL –∏–∑ Python

–ü–æ—Å–ª–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –Ω—É–∂–µ–Ω **–∫—É—Ä—Å–æ—Ä** ‚Äî –æ–±—ä–µ–∫—Ç, —á–µ—Ä–µ–∑ –∫–æ—Ç–æ—Ä—ã–π:
- –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è SQL-–∑–∞–ø—Ä–æ—Å—ã,
- —á–∏—Ç–∞—é—Ç—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.

### –°–æ–∑–¥–∞–Ω–∏–µ –∏ –∑–∞–∫—Ä—ã—Ç–∏–µ –∫—É—Ä—Å–æ—Ä–∞

```py
cursor = connection.cursor()   # —Å–æ–∑–¥–∞—Ç—å
# ...
cursor.close()                 # –∑–∞–∫—Ä—ã—Ç—å
```

- –æ–¥–∏–Ω –∫—É—Ä—Å–æ—Ä –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è **–Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤**;
- –ø–æ—Å–ª–µ –∑–∞–∫—Ä—ã—Ç–∏—è –∫—É—Ä—Å–æ—Ä–∞, –¥–ª—è –Ω–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π;
- –∫—É—Ä—Å–æ—Ä —Å–∞–º –ø–æ —Å–µ–±–µ **–Ω–µ —Å–æ–∑–¥–∞—ë—Ç—Å—è** ‚Äî —Ç–æ–ª—å–∫–æ —è–≤–Ω–æ —á–µ—Ä–µ–∑ `connection.cursor()`.

### –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤

```py
cursor = connection.cursor()
cursor.execute("SELECT * FROM departments")
```

–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:
- `cursor.execute(sql)` –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å—Ç—Ä–æ–∫—É SQL –Ω–∞ —Å–µ—Ä–≤–µ—Ä;
- –º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å –ª—é–±—ã–µ –∑–∞–ø—Ä–æ—Å—ã: `SELECT`, `INSERT`, `UPDATE`, `DELETE`, `CREATE` –∏ —Ç.–¥.;
- –ø—Ä–∏ –æ—à–∏–±–∫–µ –≤ SQL –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –∏—Å–∫–ª—é—á–µ–Ω–∏–µ;
- –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –¥—Ä–∞–π–≤–µ—Ä—ã —Ç—Ä–µ–±—É—é—Ç, —á—Ç–æ–±—ã –ø–µ—Ä–µ–¥ –Ω–æ–≤—ã–º –∑–∞–ø—Ä–æ—Å–æ–º –±—ã–ª–∏ –ø—Ä–æ—á–∏—Ç–∞–Ω—ã —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å—Ç–∞—Ä–æ–≥–æ.

---

## 5) –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤: `fetchone`, `fetchmany`, `fetchall`, –∏—Ç–µ—Ä–∞—Ü–∏—è –ø–æ –∫—É—Ä—Å–æ—Ä—É

–ü–æ—Å–ª–µ `SELECT` –¥–∞–Ω–Ω—ã–µ –æ—Å—Ç–∞—é—Ç—Å—è –≤ –∫—É—Ä—Å–æ—Ä–µ, –ø–æ–∫–∞ –≤—ã –∏—Ö –Ω–µ –∑–∞–±–µ—Ä—ë—Ç–µ.

### –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã

| –ú–µ—Ç–æ–¥             | –ß—Ç–æ –¥–µ–ª–∞–µ—Ç                            |
|-------------------|---------------------------------------|
| `fetchone()`      | –≤–µ—Ä–Ω—É—Ç—å **–æ–¥–Ω—É** —Å–ª–µ–¥—É—é—â—É—é —Å—Ç—Ä–æ–∫—É     |
| `fetchall()`      | –≤–µ—Ä–Ω—É—Ç—å **–≤—Å–µ –æ—Å—Ç–∞–≤—à–∏–µ—Å—è** —Å—Ç—Ä–æ–∫–∏     |
| `fetchmany(size)` | –≤–µ—Ä–Ω—É—Ç—å —É–∫–∞–∑–∞–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫    |

–ü—Ä–∏–º–µ—Ä:

```py
cursor.execute("SELECT * FROM departments")

row = cursor.fetchone()    # –æ–¥–Ω–∞ —Å—Ç—Ä–æ–∫–∞
print("One row:", row)

rows_5 = cursor.fetchmany(5)
print("Five rows:")
for r in rows_5:
    print("   ", r)

rows = cursor.fetchall()   # –≤—Å–µ –æ—Å—Ç–∞–≤—à–∏–µ—Å—è —Å—Ç—Ä–æ–∫–∏
print("All rows:")
for r in rows:
    print("   ", r)
```

–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:
- –ø–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ —Å—Ç—Ä–æ–∫–∏ —Å—á–∏—Ç–∞–Ω—ã, –ø–æ–≤—Ç–æ—Ä–Ω—ã–π `fetchall()` –≤–µ—Ä–Ω—ë—Ç **–ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫**, `fetchone()` ‚Äî `None`;
- `fetchmany(size)` —É–¥–æ–±–Ω–æ –Ω–∞ –±–æ–ª—å—à–∏—Ö –≤—ã–±–æ—Ä–∫–∞—Ö ‚Äî —á–∏—Ç–∞–µ–º –ø–æ—Ä—Ü–∏—è–º–∏;
- –¥–∞–Ω–Ω—ã–µ –Ω–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∑–∞—Ä–∞–Ω–µ–µ ‚Äî —á–∏—Ç–∞—é—Ç—Å—è –ø–æ –º–µ—Ä–µ –≤—ã–∑–æ–≤–æ–≤ –º–µ—Ç–æ–¥–æ–≤;
- –∫—É—Ä—Å–æ—Ä ‚Äî —ç—Ç–æ **–∏—Ç–µ—Ä–∞—Ç–æ—Ä**: –º–æ–∂–Ω–æ –ø—Ä–æ—Å—Ç–æ –ø–∏—Å–∞—Ç—å

```py
cursor.execute("SELECT * FROM employees")
for row in cursor:
    print(row)
```

–≠—Ç–æ —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω–æ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–º –≤—ã–∑–æ–≤–∞–º `fetchone()`, –Ω–æ –∫–æ—Ä–æ—á–µ.

---

## 6) –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã (–ø–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã `%s`)

–ù–∏–∫–æ–≥–¥–∞ –Ω–µ –≤—Å—Ç–∞–≤–ª—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –≤–≤–æ–¥ –ø—Ä—è–º–æ –≤ SQL-—Å—Ç—Ä–æ–∫—É ‚Äî —ç—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ **SQL‚Äë–∏–Ω—ä–µ–∫—Ü–∏—è–º**.

–ü–ª–æ—Ö–æ:

```py
user_input = "1 OR 1=1"
sql = f"SELECT * FROM employees WHERE employee_id = {user_input}"
cursor.execute(sql)  # –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è "‚Ä¶ WHERE employee_id = 1 OR 1=1"
```

–í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º **–ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä—ã** `%s` –∏ –ø–µ—Ä–µ–¥–∞—ë–º –∑–Ω–∞—á–µ–Ω–∏—è –æ—Ç–¥–µ–ª—å–Ω–æ:

```py
cursor.execute(
    "SELECT * FROM table_name WHERE column1 = %s AND column2 > %s",
    (value1, value2),
)
```

- –ø–µ—Ä–≤—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç ‚Äî SQL —Å `%s` –Ω–∞ –º–µ—Å—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–π;
- –≤—Ç–æ—Ä–æ–π ‚Äî –∫–æ—Ä—Ç–µ–∂/—Å–ø–∏—Å–æ–∫ –∑–Ω–∞—á–µ–Ω–∏–π –≤ **—Ç–æ–º –∂–µ –ø–æ—Ä—è–¥–∫–µ**, —á—Ç–æ –∏ –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä—ã.

### –ü—Ä–∏–º–µ—Ä —Å –¥–≤—É–º—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏

```py
cursor.execute(
    "SELECT * FROM employees WHERE department_id = %s OR salary > %s",
    (60, 20000),
)
for r in cursor:
    print(r)
```

### –û–¥–∏–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä ‚Üí –Ω–µ –∑–∞–±—ã–≤–∞–µ–º –∑–∞–ø—è—Ç—É—é

```py
cursor.execute(
    "SELECT * FROM employees WHERE department_id = %s",
    (100,),      # –∫–æ—Ä—Ç–µ–∂ –∏–∑ –æ–¥–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞
)
```

### –ü–ª—é—Å—ã –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

- –∑–∞—â–∏—Ç–∞ –æ—Ç SQL‚Äë–∏–Ω—ä–µ–∫—Ü–∏–π;
- –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ —Å–∞–º–∞ —ç–∫—Ä–∞–Ω–∏—Ä—É–µ—Ç —Å—Ç—Ä–æ–∫–∏ –∏ –ø—Ä–∏–≤–æ–¥–∏—Ç —Ç–∏–ø—ã;
- –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ SQL –º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å —Å —Ä–∞–∑–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏;
- —Å–µ—Ä–≤–µ—Ä –º–æ–∂–µ—Ç –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å –ø–ª–∞–Ω –∑–∞–ø—Ä–æ—Å–∞ ‚Üí –≤—ã—à–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å.

---

## 7) –ò–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã: `%(name)s` + —Å–ª–æ–≤–∞—Ä—å

–ö–æ–≥–¥–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –º–Ω–æ–≥–æ, —É–¥–æ–±–Ω–µ–µ **–∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–µ** –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä—ã:

```py
cursor.execute(
    """
    SELECT * FROM table_name
    WHERE column1 = %(param1)s AND column2 > %(param2)s
    """,
    {"param1": value1, "param2": value2},
)
```

- –≤ SQL –∏—Å–ø–æ–ª—å–∑—É–µ–º `%(–∏–º—è)s`;
- –≤—Ç–æ—Ä—ã–º –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º –æ—Ç–¥–∞—ë–º —Å–ª–æ–≤–∞—Ä—å —Å —Ç–∞–∫–∏–º–∏ –∂–µ –∫–ª—é—á–∞–º–∏;
- –ø–æ—Ä—è–¥–æ–∫ –∫–ª—é—á–µ–π –Ω–µ –≤–∞–∂–µ–Ω ‚Äî –≤–∞–∂–Ω—ã –∏–º–µ–Ω–Ω–æ –∏–º–µ–Ω–∞.

–ü—Ä–∏–º–µ—Ä:

```py
cursor.execute(
    """
    SELECT * FROM employees
    WHERE department_id = %(dep_id)s OR salary > %(min_salary)s
    """,
    {"min_salary": 20000, "dep_id": 60},
)
for r in cursor:
    print(r)
```

–ü–ª—é—Å—ã:
- –ª—É—á—à–µ —á–∏—Ç–∞–µ—Ç—Å—è –∑–∞–ø—Ä–æ—Å;
- —É–¥–æ–±–Ω–æ, –∫–æ–≥–¥–∞ –¥–∞–Ω–Ω—ã–µ —É–∂–µ –ø—Ä–∏—Ö–æ–¥—è—Ç –≤ –≤–∏–¥–µ —Å–ª–æ–≤–∞—Ä—è;
- –º–µ–Ω—å—à–µ —Ä–∏—Å–∫–∞ –ø–µ—Ä–µ–ø—É—Ç–∞—Ç—å –ø–æ—Ä—è–¥–æ–∫ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤.

---

## 8) –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ (`try/except` –∏ `pymysql.MySQLError`)

–¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏:
- –Ω–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å/—Ö–æ—Å—Ç;
- –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π SQL;
- –Ω–µ—Ç —Ç–∞–±–ª–∏—Ü—ã;
- –Ω–∞—Ä—É—à–µ–Ω–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π (—É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å –∏ —Ç.–ø.).

–ß—Ç–æ–±—ã –ø—Ä–æ–≥—Ä–∞–º–º–∞ –Ω–µ –ø–∞–¥–∞–ª–∞, –æ–±–æ—Ä–∞—á–∏–≤–∞–µ–º –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤ `try/except`.

### –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

```py
import pymysql

try:
    connection = pymysql.connect(
        host="ich-db.edu.itcareerhub.de",
        user="root",
        password="wrong_password",   # –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–∞—Ä–æ–ª—å
        database="test",
    )
    print("Connected!")
except pymysql.MySQLError as e:
    print("Connection error:", e)
```

### –û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞

```py
try:
    with connection.cursor() as cursor:
        cursor.execute("SELECT * FROM non_existing_table")
        result = cursor.fetchall()
except pymysql.MySQLError as e:
    print("Query error:", e)
```

–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:
- –±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –≤—Å–µ—Ö –∏—Å–∫–ª—é—á–µ–Ω–∏–π PyMySQL: `pymysql.MySQLError`;
- –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –º–æ–∂–Ω–æ –ª–æ–≤–∏—Ç—å –±–æ–ª–µ–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ:  
  `pymysql.ProgrammingError`, `pymysql.OperationalError` –∏ —Ç.–¥.

---

## 9) –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä `with` –¥–ª—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –∏ –∫—É—Ä—Å–æ—Ä–∞

–ß—Ç–æ–±—ã –Ω–µ –∑–∞–±—ã–≤–∞—Ç—å –∑–∞–∫—Ä—ã–≤–∞—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∏ –∫—É—Ä—Å–æ—Ä—ã, –∏—Å–ø–æ–ª—å–∑—É–µ–º `with`.

```py
import pymysql

with pymysql.connect(
    host="ich-db.edu.itcareerhub.de",
    user="ich1",
    password="password",
    database="hr",
) as connection:                   # –ø–æ –≤—ã—Ö–æ–¥—É –∏–∑ –±–ª–æ–∫–∞ connection.close()
    with connection.cursor() as cursor:   # –ø–æ –≤—ã—Ö–æ–¥—É cursor.close()
        cursor.execute("SELECT * FROM employees")
        for row in cursor:
            print(row)
```

–ü–ª—é—Å—ã `with`:
- –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–∑—ã–≤–∞–µ—Ç `close()` –¥–∞–∂–µ –ø—Ä–∏ –∏—Å–∫–ª—é—á–µ–Ω–∏—è—Ö;
- –∫–æ–¥ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –∫–æ—Ä–æ—á–µ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–µ–µ;
- –≤–Ω—É—Ç—Ä–∏ –º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å –ª—é–±—ã–µ –∑–∞–ø—Ä–æ—Å—ã, –Ω–µ —Ç–æ–ª—å–∫–æ `SELECT`.

---

## 10) –ó–∞–¥–∞–Ω–∏—è —Å —É—Ä–æ–∫–∞ ‚Äî –æ—Ç–≤–µ—Ç—ã (–∫–æ—Ä–æ—Ç–∫–æ)

### –ó–∞–∫—Ä–µ–ø–ª–µ–Ω–∏–µ 1 (–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∏ –∫—É—Ä—Å–æ—Ä)

1. –°–æ–ø–æ—Å—Ç–∞–≤—å—Ç–µ –ø–æ–Ω—è—Ç–∏–µ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º:

1. `pymysql.connect()`  
2. `cursor.execute()`  
3. `connection.close()`  
4. `cursor = connection.cursor()`  

‚Üí **–û—Ç–≤–µ—Ç:** 1‚Äìd, 2‚Äìb, 3‚Äìa, 4‚Äìc  

- d: —Å–æ–∑–¥–∞—ë—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ MySQL  
- b: –≤—ã–ø–æ–ª–Ω—è–µ—Ç SQL‚Äë–∑–∞–ø—Ä–æ—Å  
- a: –∑–∞–∫—Ä—ã–≤–∞–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ  
- c: —Å–æ–∑–¥–∞—ë—Ç –∫—É—Ä—Å–æ—Ä

2. –í—ã–±–µ—Ä–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è:

- –≤–µ—Ä–Ω—ã–µ: **c, e**  
  - c: –æ–¥–∏–Ω –∫—É—Ä—Å–æ—Ä –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤  
  - e: `connection.open` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ç–∞—Ç—É—Å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è

### –ó–∞–∫—Ä–µ–ø–ª–µ–Ω–∏–µ 2 (–ø–∞—Ä–∞–º–µ—Ç—Ä—ã, fetch, with)

1. –ó–∞—á–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã?  
   ‚Üí **b, c:** –∑–∞—â–∏—Ç–∞ –æ—Ç SQL‚Äë–∏–Ω—ä–µ–∫—Ü–∏–π + –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–Ω–∞—á–µ–Ω–∏–π –∏ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ.

2. –ß—Ç–æ –±—É–¥–µ—Ç, –µ—Å–ª–∏ –≤—ã–∑–≤–∞—Ç—å `fetchall()` –µ—â—ë —Ä–∞–∑ –ø–æ—Å–ª–µ —á—Ç–µ–Ω–∏—è –≤—Å–µ—Ö —Å—Ç—Ä–æ–∫?  
   ‚Üí –í–µ—Ä–Ω—ë—Ç—Å—è **–ø—É—Å—Ç–∞—è –∫–æ–ª–ª–µ–∫—Ü–∏—è** (—Å–ø–∏—Å–æ–∫).

3. –ö–∞–∫–∏–µ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –≤–µ—Ä–Ω—ã –¥–ª—è `with`?  
   ‚Üí **a, b, c:**  
   - —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –±–ª–æ–∫–∞ `with`;  
   - –≤–Ω—É—Ç—Ä–∏ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–ª–æ–∂–µ–Ω–Ω—ã–π `with connection.cursor()`;  
   - `with` –ø–æ–º–æ–≥–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–∫—Ä—ã—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–∞–∂–µ –ø—Ä–∏ –æ—à–∏–±–∫–µ.

---

## 11) –î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ ‚Äî –∏–¥–µ–∏ —Ä–µ—à–µ–Ω–∏–π

> –î–æ–º–∞—à–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –±–∞–∑—É **world** (—Ç–∞–±–ª–∏—Ü—ã `country`, `city`). –ü—Ä–∏–º–µ—Ä—ã –Ω–∏–∂–µ ‚Äî –æ–±—â–∏–π —à–∞–±–ª–æ–Ω, –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –ø–æ–¥—Å—Ç–∞–≤—å —Å–≤–æ–∏.

### –î–ó 1. –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Å—Ç—Ä–∞–Ω —Å –Ω—É–º–µ—Ä–∞—Ü–∏–µ–π

**–ó–∞–¥–∞—á–∞:** –≤—ã–≤–µ—Å—Ç–∏ –≤—Å–µ —Å—Ç—Ä–∞–Ω—ã –∏–∑ `country` –≤ —Ñ–æ—Ä–º–∞—Ç–µ:

```text
1. Aruba
2. Afghanistan
...
```

–ü—Ä–∏–º–µ—Ä —Ä–µ—à–µ–Ω–∏—è:

```py
import pymysql

config = {
    "host": "localhost",
    "user": "root",
    "password": "password",
    "database": "world",
    "charset": "utf8mb4",
}

with pymysql.connect(**config) as connection:
    with connection.cursor() as cursor:
        cursor.execute("SELECT Name FROM country ORDER BY Name")
        countries = cursor.fetchall()

for i, (name,) in enumerate(countries, start=1):
    print(f"{i}. {name}")
```

### –î–ó 2. –ì–æ—Ä–æ–¥–∞ –≤—ã–±—Ä–∞–Ω–Ω–æ–π —Å—Ç—Ä–∞–Ω—ã

**–ó–∞–¥–∞—á–∞:**
1. —Å–ø—Ä–æ—Å–∏—Ç—å —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞–∑–≤–∞–Ω–∏–µ —Å—Ç—Ä–∞–Ω—ã;
2. –≤—ã–≤–µ—Å—Ç–∏ –≥–æ—Ä–æ–¥–∞ —ç—Ç–æ–π —Å—Ç—Ä–∞–Ω—ã –∏ –Ω–∞—Å–µ–ª–µ–Ω–∏–µ (`city.Name`, `city.Population`).

–ü—Ä–∏–º–µ—Ä —Ä–µ—à–µ–Ω–∏—è:

```py
import pymysql

config = {
    "host": "localhost",
    "user": "root",
    "password": "password",
    "database": "world",
    "charset": "utf8mb4",
}

country_name = input("–í–≤–µ–¥–∏—Ç–µ —Å—Ç—Ä–∞–Ω—É: ")

with pymysql.connect(**config) as connection:
    with connection.cursor() as cursor:
        sql = """
        SELECT city.Name, city.Population
        FROM city
        JOIN country ON city.CountryCode = country.Code
        WHERE country.Name = %s
        ORDER BY city.Population DESC
        """
        cursor.execute(sql, (country_name,))
        rows = cursor.fetchall()

if not rows:
    print("–ì–æ—Ä–æ–¥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã (–ø—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Å—Ç—Ä–∞–Ω—ã).")
else:
    for name, population in rows:
        print(f"{name} ‚Äî {population}")
```

---

## –ú–∏–Ω–∏-—à–ø–∞—Ä–≥–∞–ª–∫–∞ —É—Ä–æ–∫–∞

```text
–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:
import pymysql
conn = pymysql.connect(host=..., user=..., password=..., database=...)
cursor = conn.cursor()
cursor.execute("SELECT ...")

–ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö:
fetchone()   -> –æ–¥–Ω–∞ —Å—Ç—Ä–æ–∫–∞ –∏–ª–∏ None
fetchmany(n) -> n —Å—Ç—Ä–æ–∫
fetchall()   -> —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è —Å—Ç—Ä–æ–∫
for row in cursor: ...  # –∫—É—Ä—Å–æ—Ä –∫–∞–∫ –∏—Ç–µ—Ä–∞—Ç–æ—Ä

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
cursor.execute("... WHERE id = %s", (value,))
cursor.execute("... WHERE x = %(x)s", {"x": value})

–û—à–∏–±–∫–∏:
try/except pymysql.MySQLError

–ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ –º–µ–Ω–µ–¥–∂–µ—Ä—ã:
with pymysql.connect(...) as conn:
    with conn.cursor() as cursor:
        cursor.execute(...)
```


---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

_–≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª –±—É–¥–µ—Ç –¥–æ–ø–æ–ª–Ω–µ–Ω –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–º–∏ –ø—Ä–∏–º–µ—Ä–∞–º–∏ –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π._
