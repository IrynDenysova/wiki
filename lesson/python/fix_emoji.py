#!/usr/bin/env python3
# -*- coding: utf-8 -*-
import re
from pathlib import Path

root = Path('.')
files = sorted([p for p in root.glob('*.md') if p.name[0].isdigit()])

for p in files:
    text = p.read_text(encoding='utf-8')
    original = text
    
    # 1. –ó–∞–º–µ–Ω—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫: "## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è" -> "## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è"
    text = re.sub(r'## üìö\s+–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è', 
                  '## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è', text)
    
    # 2. –ó–∞–º–µ–Ω—è–µ–º —Å—Å—ã–ª–∫–∏ –≤ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ (wiki-—Ñ–æ—Ä–º–∞—Ç): 
    # "[[#üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è]](#...)" -> "[[#–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è]](#...)"
    text = re.sub(r'\[\[#üìö\s+–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è\]\]',
                  '[[#–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è]]', text)
    
    # 3. –¢–∞–∫–∂–µ –æ–±–Ω–æ–≤–ª—è–µ–º —Å–æ–∫—Ä–∞—â—ë–Ω–Ω—ã–µ —Å—Å—ã–ª–∫–∏ (–µ—Å–ª–∏ **[[ ]]]):
    text = re.sub(r'\*\*\[\[#üìö\s+–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è\]\]',
                  '**[[#–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è]]', text)
    
    if text != original:
        p.write_text(text, encoding='utf-8')
        print(f'fixed: {p.name}')

print('done')
